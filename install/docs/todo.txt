High Prio
---------

Other-Controls-Daemon ( initially for OrviboS20s )
    write manual_auto_timeout ( like relay-manual code )

    more than one can run.
        need to modify the CommandQueueDaemon to allow this.
        new setting for ( currently only Orvibo S20s) called "poll_host" ( optional )
        This will be name of the host where a running Other-Controls-D will poll the control.
        If an orvibo-s20-control doesn't have this setting it will NOT get polled.

    remove the rand() in the time checking of the last-poll part.

    Will behave like a PiControllerDaemon and listen for commands from PiControllerQueue.
    Main reason for it is so that it can be treated as a relay-manual type of control.


Pi-Control-Daemon
    use the ControlDispatch.pm. tricky.


The messages to support new fields
    "action_by"  This will currently be :
        Manual ( a plain old wall switch operated it. or something outside khaospy)
        Manual-WebUI ( someone click in the webui )
        Auto-Rules
    So an action knows the classification of what called it.
    last_change_state_by

    Rules will then be able to be subtle.
    i.e. if a light is operated by a manual wall switch then the rules-d can be more subtle.
    The manual_auto_timeout could be deprecated if the rules-D can be made aware of the action_by information.

    ( action_by_user to indicate user-name. do we need this ? )


CommandQueueDaemon
    get it to subscribe to as many Pi-Controls-D or Other-Controls-D as there are.
    There needs to be at least 1 subscription. But that is all.


a way of distributing the confs to all hosts.
    scp / tar . whatever. something quick and easy.


pi-hosts. config checking. make sure there is only :
    one heating-control-daemon
    one boiler-daemon
    one rules-daemon


get BoilerDaemon.pm able to use the ControlPi stuff.
    BoilerDaemon needs to listen to the outputs of :
        PiControlD
        OtherControlD
    for the state of controls.

    The refresh status can be dropped.
        ( once I've got other Controls polling )



make a lead to run thermometers and both i2cs for piserver.


write a cli tool that will summarise the confs nicely .
    pi-hosts
    controls
    one-wire-heating-daemon
    boiler

get OneWireHeatingDaemon
    able to use the ControlPi stuff..

    make the pi-hosts config die if there is more than one-heating-control-daemon configured.


get piboiler able to run the PC-queue-d.
    try reinstall of dependencies.

In my loft.
    thermometers in my room , kitchen and my loft.
    i2c-controller.

    get the outside thermometer working properly.

    maybe get ali's window switch wired in to alarm board.




jumper pins from PHouse. leave some in the alarm-panel.

write more tests for the the code in Khaospy::PiControlMCP23017

raise proper named exceptions and don't just die.

Test that PiControllerDaemon.pm subscribes to the correct hosts.

Test that the following stuff works
    pi-gpio-relay
    pi-gpio-relay-manual
        make an ex-or type circuit and test that.

Get the electronic/physical PiMCP23017 interface working


run it on PiServer for the Alarm Interface board.

wire up some alarm-sensors.

write the :
    stuff to get boiler control actaully running on a pi-gpio-relay-manual.

    a quick CH Webpage.


Conf::PiHosts.

    Go over the PiControllerDaemon and PiControllerQueueDaemon and tidy up. proper exception handling. Try::Tiny. and raise proper exeptions. not dies. give them a name.

Starting writing the PiMCP23017 module . need this  for th alarm switch panel.  with tests. lots of work. ( finish of the PiGPIO first, some of the logic could be shared. )

    daemons need locking. the "/usr/bin/daemon" should do this , but it looked broken recently.

    fix the quoting of CLI params in khaospy-run-daemons.pl

    Khaospy::RRDGraphDaemon
        need an rrd-config. for grouping. maybe.
        use the control config "rrd_graph" for what to graph.
        has to listen to all different message status streams.

    a better way of distributing the /etc/hosts. preferably just go for a DNS server for my local hostnames.

    make boiler on/off with rad states page.

Why are there a lot of tmpfs using up lots of ram on jessie version of raspibian ?

Medium Prio
-----------

Multiway lighting, am I going to program up something in khaospy for Amelia's controller ? Am I going to build a new controller using SSRs ?



does the pi-host.conf need to have valid_i2c_buses ? This can be worked out with an i2c-detect ? maybe I need both. When khaospy actually runs on the host then it can do  an i2c-detect too.


control config. an option for db-logging of state changes. ( already have the rrd_graph option )


Implement for the OrviboS20 : remember the last state, and if its been manually operated by something other than khaospy. just like the PiGPIO relay-manual controls. Useful for "rules". Useful if I use them for light-switches.


pi dns and dhcp server.


pibastion that I can open to the net and just get stats.

Low prio
--------

    onewire sender in perl. low priority. python one is working.

    rrd-creater in perl. low prio. python one is working.
        temp rrds
        switch / relay / control rrds.


    conf-dist-daemon in perl. very low prio. I can do this with tar-over-ssh, scp etc.

    daemon-monitor. long way off. i.e. when I've got the rest of the stuff working, with some sort of webui (or openhab)

